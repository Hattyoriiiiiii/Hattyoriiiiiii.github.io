---
layout: post
author: hattyoriiiiiii
title: 解析ツールのインストールと実行の仕方
date: 2022-10-17
description: Google Colabを用いて、ClustalWのインストールと実行する
tags: tips biology
categories: 環境構築 Colaboratory
---

<br>

### 概要

- [ClustalW](http://www.clustal.org)は、アライメントや系統樹を作製するためのツール。
  - サイトにもあるように、実際にClustalを使うときは最新の`Clustal Omega`を使うことが望ましい。
- Google Colab上で、ClustalWを例として、解析ツールのインストールと実行をする。
- LinuxやMacでインストールしたい際にも利用する汎用的な方法を説明する。

<br>

### やりたい事

- ClustalWのインストール
- ClustalWの実行


<br>

### Google ColabでClustalW

<br>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/blog/2022/2022-10-19-clustalw_01.png" title="example image" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    こんな感じになればインストール成功
</div>

<br>

次に、各コマンドについて一言。

これらのコマンドは、Google Colab以外の環境(LinuxやMac)で**解析ツールをダウンロードする際にも使うので、知っている必要がある**(何回もやってると覚える)。

<br>


```bash
%%bash
```

- `%%bash`は、マジックコマンドという。
  - これだけは、Google Colab (Jupyter Notebook)でのみ、利用可能なコマンド。
  - `%`はラインマジック、`%%`はセルマジックという。
  - `%%bash`を先頭につけたセルは、Bashが書けるようになる。

<br>

```bash
# 「src」というディレクトリを作成し、移動する
mkdir -p /content/src && cd $_
```

- `mkdir -p <path>`
- `&&`
  - `<command1> && <command2>`でcommand1が成功したらcommand2を実行する、という意味になる。
- `cd $_`
  - 直前に指定したpath(正確には直前に実行したコマンドの最後の引数)を勝手に指定してくれる。
  - ここでは、`/content/src`と同じ意味がある。

<br>

```bash
# ClustalWのダウンロード
wget -q http://www.clustal.org/download/2.1/clustalw-2.1-linux-x86_64-libcppstatic.tar.gz

# Clustal Omegaのダウンロード (実行しなくて良い)
# wget -q http://www.clustal.org/omega/clustal-omega-1.2.4.tar.gz
```

- `wget <URL>`は、URL先のファイルをダウンロードするコマンド。
  - `-q`(quiet)を付けないと色々出力が出てくる。付けなくても良い。
- 以下のリンク先から手持ちの端末に合わせたリンクを貼ってダウンロードする。
  - [http://www.clustal.org/download/current/](http://www.clustal.org/download/current/)
  - URLの最後が`.tar.gz`で終わっているか確認する。


<br>

```bash
# tarファイルの解凍
tar -xvzf clustalw-2.1-linux-x86_64-libcppstatic.tar.gz
```

- `tar -xvzf`は、`.tar.gz`ファイルを解凍するコマンド。
  - ファイルが解凍されると新しいディレクトリができる。

<br>

```bash
# シンボリックリンクの作成
ln -s /content/src/clustalw-2.1-linux-x86_64-libcppstatic/clustalw2 /usr/local/bin/
```

- `ln -s`は、シンボリックリンクを貼るときに用いるコマンド。
  - `/usr/local/bin/`に`clustalw2`というコマンドへのショートカットを置いているイメージ。
  - これを実行することで、どこのディレクトリからも`clustalw2`というコマンドだけで実行できるようになる。
  - これをやらない場合、毎回`/content/src/clustalw-2.1-linux-x86_64-libcppstatic/clustalw2`(絶対パス)もしくは、相対パスで指定する必要がある。

<br>

```bash
# インストールが成功しているかを確認
clustalw2 -HELP

# Clustal Omega (実行しなくて良い)
# clustalo --help
```

- 大体のツールは、`<command> --help`、もしくは、その省略形の`<command> -h`で実行できる場合が多い。

<br>
<br>

### ClustalWの実行

まずは、最初に[Google Drive](/blog/2022/GoogleColab/)に接続しておく。

<br>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        {% include figure.html path="assets/img/blog/2022/2022-10-19-clustalw_02.png" title="example image" class="img-fluid rounded z-depth-1" %}
    </div>
</div>
<div class="caption">
    こんな感じになれば実行成功
</div>

<br>


- `input.txt`を用意して、Google Driveのこのnotebookが保存されている位置と同じディレクトリ(`pwd`で確認できる)に保存する。
- 中身は以下のような構造のファイル(fasta形式)。

```
>Human
ACAGCTTCATCACATCACAT
>Dog
ACGTACTACTGCATACGTACC
>Cat
CTATAAAACGACACCAGA

```

<br>

このnotebook(`clustalw.ipynb`)と`input.txt`が同じディレクトリに存在することを確認する。

```bash
ll
total 16
-rw------- 1 root 15803 Oct 19 02:56 clustalw.ipynb
-rw------- 1 root    79 Oct 13 08:26 input.txt
```

- `ll`は`ls -F -o --color`というコマンドが登録されている(`alias`コマンドで確認)。
- `ls`コマンドは現在いるディレクトリ内以下に存在するファイルやディレクトリを表示する。
  - `-F`
    - 各ファイルやディレクトリの状態がわかる(e.g. `<directory>/`)。
  - `-o`
    - `ls`とは異なり、ファイルを縦方向に表示する。
  - `--color`
    - ファイルの種類によって色分け表示される。

<br>

```bash
!clustalw2 input.txt -outfile=output.txt
```

- これを実行すると、`output.txt`と`input.dnd`という2つのファイルが出てくる。
- `ll`コマンドで出力されたか確認。

<br>

```bash
!head output.txt
```

- `head`
  - ファイルの先頭10行を表示するコマンド。

